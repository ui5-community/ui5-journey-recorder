<mvc:View
    controllerName="com.ui5.journeyrecorder.controller.JourneyPage"
    displayBlock="true"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:layout="sap.ui.layout"
    xmlns:uxap="sap.uxap"
    xmlns:code="sap.ui.codeeditor"
    xmlns:recorder="com.ui5.journeyrecorder.control"
    xmlns:mvc="sap.ui.core.mvc"
>
    <Page>
        <customHeader>
            <Bar>
                <contentLeft>
                    <Button
                        type="Back"
                        press=".onNavBack"
                    />
                    <Image
                        src="assets/icons/ui5_journey_recorder.png"
                        height="2.5rem"
                    />
                    <Title text="{i18n>appTitle}" />
                </contentLeft>
                <contentRight>
                    <Button
                        icon="sap-icon://action-settings"
                        press=".onOpenSettingsDialog"
                    />
                </contentRight>
            </Bar>
        </customHeader>
        <content>
            <uxap:ObjectPageLayout>
                <uxap:headerTitle>
                    <uxap:ObjectPageDynamicHeaderTitle
                        class="journey-page-header"
                    >
                        <uxap:heading>
                            <recorder:EditableTitle
                                prefix="{i18n>journey}:"
                                text="{journey>/name}"
                            />
                        </uxap:heading>
                        <uxap:expandedContent>
                            <HBox
                                justifyContent="SpaceBetween"
                                width="100%"
                            >
                                <layout:VerticalLayout>
                                    <ObjectStatus
                                        title="Site-Url"
                                        text="{journey>/startUrl}"
                                    />
                                    <ObjectStatus
                                        title="UI5 Version"
                                        text="{journey>/ui5Version}"
                                    />
                                </layout:VerticalLayout>
                                <layout:VerticalLayout>
                                    <ObjectStatus
                                        title="Created"
                                        text="{
                                    path: 'journey>/created',
                                    formatter: '.dateTimeFormatter'
                                }"
                                    />
                                    <ObjectStatus
                                        title="Latest Edit"
                                        text="{
                                    path: 'journey>/edited',
                                    formatter: '.dateTimeFormatter'
                                }"
                                    />
                                </layout:VerticalLayout>
                            </HBox>
                        </uxap:expandedContent>
                        <uxap:actions>
                            <Button
                                icon="sap-icon://connected"
                                press="onConnect"
                                text="Connect"
                                visible="{= ${path: '/connectionStatus'} !== 'connected' &amp;&amp; ${path: '/connectionStatus'} !== 'connecting'}"
                            />
                            <Button
                                icon="sap-icon://disconnected"
                                press="onDisconnect"
                                text="Disconnect"
                                visible="{= ${path: '/connectionStatus'} === 'connected'}"
                            />
                        </uxap:actions>
                    </uxap:ObjectPageDynamicHeaderTitle>
                </uxap:headerTitle>
                <uxap:sections>
                    <uxap:ObjectPageSection
                        titleUppercase="false"
                        title="Journey Steps"
                    >
                        <uxap:subSections>
                            <uxap:ObjectPageSubSection titleUppercase="false">
                                <uxap:blocks>
                                    <List
                                        items="{journey>/steps}"
                                        class="step-list"
                                    >
                                        <items>
                                            <CustomListItem
                                                type="Navigation"
                                                class="step-item"
                                                press=".navigateToStep"
                                            >
                                                <HBox>
                                                    <Button
                                                        icon="sap-icon://bo-strategy-management"
                                                        enabled="false"
                                                        type="Transparent"
                                                    />
                                                    <VBox>
                                                        <Title
                                                            text="{journey>control/controlId/id}"
                                                        />
                                                        <Text
                                                            text="{journey>actionLocation}"
                                                        />
                                                    </VBox>
                                                </HBox>
                                            </CustomListItem>
                                        </items>
                                    </List>
                                </uxap:blocks>
                                <uxap:actions>
                                    <Button
                                        icon="sap-icon://restart"
                                        press="onReplay"
                                        text="Replay"
                                        visible="{= !${path: 'journeyControl>/replayEnabled'}}"
                                    />
                                    <Button
                                        icon="sap-icon://stop"
                                        press="onStopReplay"
                                        text="Stop Replay"
                                        visible="{= ${path: 'journeyControl>/replayEnabled'}}"
                                    />
                                </uxap:actions>
                            </uxap:ObjectPageSubSection>
                        </uxap:subSections>
                    </uxap:ObjectPageSection>

                    <uxap:ObjectPageSection
                        titleUppercase="false"
                        title="Code"
                    >
                        <uxap:subSections>
                            <uxap:ObjectPageSubSection titleUppercase="false">
                                <uxap:actions>
                                    <Button
                                        icon="sap-icon://syntax"
                                        text="Change Framework"
                                        press="frameworkChange"
                                    />
                                    <Button
                                        icon="sap-icon://download"
                                        text="Download TestCode"
                                        press="onCodeDownload"
                                    />
                                </uxap:actions>
                                <uxap:blocks>
                                    <Panel
                                        width="auto"
                                        expanded="true"
                                        height="40rem"
                                    >
                                        <IconTabBar
                                            select=".onSelectCodeTab"
                                            expanded="true"
                                            expandable="false"
                                            class="sapUiResponsiveContentPadding"
                                            items="{journeyControl>/codes}"
                                        >
                                            <items>
                                                <IconTabFilter
                                                    text="{journeyControl>title}"
                                                    key="{journeyControl>title}"
                                                >
                                                    <code:CodeEditor
                                                        id="codeeditor"
                                                        type="javascript"
                                                        height="30rem"
                                                        editable="false"
                                                        value="{journeyControl>code}"
                                                    />
                                                </IconTabFilter>
                                            </items>
                                        </IconTabBar>
                                        <Toolbar design="Solid">
                                            <Label
                                                text="Current Framework: {journeyControl>/framework}"
                                            />
                                            <ToolbarSpacer />
                                            <Button
                                                icon="sap-icon://copy"
                                                press="onCopyCode"
                                                tooltip="Copy current editor content"
                                            />
                                        </Toolbar>
                                    </Panel>
                                </uxap:blocks>
                            </uxap:ObjectPageSubSection>
                        </uxap:subSections>
                    </uxap:ObjectPageSection>
                </uxap:sections>
            </uxap:ObjectPageLayout>
        </content>
        <footer>
            <Bar>
                <contentLeft>
                    <core:Icon
                        src="{ path: '/connectionStatus', formatter: '.connectionIcon'}"
                        color="{ path: '/connectionStatus', formatter: '.connectionColor'}"
                    />
                </contentLeft>
                <contentRight>
                    <Button
                        icon="sap-icon://download"
                        text="Export"
                        press=".onExport"
                    />
                    <Button
                        id="saveBtn"
                        icon="sap-icon://save"
                        text="Save"
                        press=".onSave"
                    />
                </contentRight>
            </Bar>
        </footer>
    </Page>
</mvc:View>
